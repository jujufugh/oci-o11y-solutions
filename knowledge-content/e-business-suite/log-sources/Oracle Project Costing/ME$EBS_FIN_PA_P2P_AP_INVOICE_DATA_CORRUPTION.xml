<?xml version="1.0" encoding="UTF-8"?>
<LoganContent oms_version="2.50.2.0.0" name="content_ocid1.tenancy.oc1..aaaaaaaa5s2vdjjrydixjulorcwozffbpna37w5a35p3jhgpyshlkmio6oiq_1650039506307" content_version="2.50.2.0.0" xmlns="http://www.oracle.com/DataCenter/LogAnalyticsStd">
    <Field oms_version="2.50.2.0.0">
        <DisplayName>sensor</DisplayName>
        <FieldType>1</FieldType>
        <IsSystem>0</IsSystem>
        <IsPrimary>1</IsPrimary>
        <DataType>STRING</DataType>
        <IsMetricKeyEligible>0</IsMetricKeyEligible>
        <IsMetricValueEligible>0</IsMetricValueEligible>
        <FacetEligible>1</FacetEligible>
        <RangeFacetEligible>0</RangeFacetEligible>
        <TableEligible>1</TableEligible>
        <FacetPriority>1</FacetPriority>
        <Summarizable>1</Summarizable>
        <HighCardinality>1</HighCardinality>
        <LargeData>0</LargeData>
        <MultiValued>0</MultiValued>
        <SMAEnabledSetting>0</SMAEnabledSetting>
    </Field>
    
    <Tag>
<Name>#medium_severity_sensor</Name>
<DisplayName>Medium Severity Sensor</DisplayName>
<IsSystem>0</IsSystem>
<ProblemPriority>MEDIUM</ProblemPriority>
</Tag>
    <Source name="EBS Sensor: FIN PA Projects Related AP Invoices Have One or More Types of Data Corruption - Weekly" oms_version="2.50.2.0.0" configWarningSettings="0">
    <SourceType>database_sql</SourceType>
    <TargetTypes>
        <TargetType>omc_oracle_db_instance</TargetType>
        <TargetType>omc_oracle_pdb</TargetType>
    </TargetTypes>
    <DisplayName>EBS Sensor: FIN PA Projects Related AP Invoices Have One or More Types of Data Corruption - Weekly</DisplayName>
    <Description><![CDATA[Various types of supplier invoice data corruption may exist which could prevent interface of data to Projects or similar errors.]]></Description>
    <IsSystem>0</IsSystem>
    <IsSecureContent>1</IsSecureContent>
    <Patterns>
        <DBPattern dateTimeField="entrytime" dateTimeColumns="entrytime">
        <SQLQuery>
            <![CDATA[select 'ME$EBS_FIN_PA_P2P_AP_INVOICE_DATA_CORRUPTION' sensor, to_timestamp(to_char(sysdate, 'YYYY-MM-DD hh24:mi:ss'), 'YYYY-MM-DD hh24:mi:ss') entrytime, 'project_number:' || s.project_number || ', project_status:' || s.project_status || ', invoice_number:' || s.invoice_number || ', pa_addition_flag:' || s.pa_addition_flag || ', rej_reason:' || s.rej_reason key_data FROM (SELECT project_number project_number,  project_status project_status,  invoice_number invoice_number,  pa_addition_flag pa_addition_flag,  rej_reason rej_reason  FROM (  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 1 :: Invoice transactions interfaced to projects with wrong pa_addition_flag'  AS rej_reason  FROM apps.ap_invoice_distributions_all d,  apps.ap_invoices_all i,  apps.pa_projects_all p  WHERE p.project_id = d.project_id  AND i.invoice_id = d.invoice_id  AND d.project_id > 0  AND d.line_type_lookup_code NOT IN ('ERV','TRV','IPV','TIPV','TERV' )  AND d.line_type_lookup_code NOT IN ('REC_TAX','RETAINAGE','PREPAY')  AND nvl(d.pa_addition_flag,'N') NOT IN ('Y','E')  AND d.posted_flag ||'' = 'Y'  AND nvl(d.reversal_flag,'N') = 'N'  AND nvl(d.historical_flag,'N') = 'N'  AND d.org_id = i.org_id  AND EXISTS (  SELECT 'X' FROM apps.pa_expenditure_items_all ei  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND ei.document_distribution_type is not null  AND nvl(ei.net_zero_Adjustment_Flag,'N') = 'N'  AND ei.transaction_source IN ('AP EXPENSE','AP INVOICE','AP NRTAX'))  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 2 :: Invoice net zero transactions interfaced to Projects stuck '||  'with wrong pa_addition_flag' AS rej_reason  FROM apps.ap_invoice_distributions_all d,  apps.ap_invoices_all i,  apps.pa_projects_all p  WHERE d.project_id > 0  AND p.project_id = d.project_id  AND i.invoice_id = d.invoice_id  AND nvl(d.pa_addition_flag,'N') <> 'Y'  AND d.line_type_lookup_code NOT IN ('REC_TAX','RETAINAGE','PREPAY')  AND d.posted_flag = 'Y'  AND nvl(d.reversal_flag,'N') = 'Y'  AND nvl(d.historical_flag,'N') = 'N'  AND d.parent_reversal_id is null  AND d.org_id = i.org_id  AND EXISTS (  SELECT 1 FROM apps.ap_invoice_distributions_all d2  WHERE d.invoice_id = d2.invoice_id  AND d2.parent_reversal_id = d.invoice_distribution_id  AND d2.pa_addition_flag = 'Y'  AND nvl(d2.reversal_Flag,'N') = 'Y'  AND EXISTS (  SELECT 1 FROM apps.pa_expenditure_items_all ei1  WHERE ei1.document_header_id = d2.invoice_id  AND ei1.document_distribution_id = d2.invoice_distribution_id))  AND EXISTS (  SELECT 1 FROM apps.pa_expenditure_items_all ei  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND ei.document_distribution_type is not null)  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 2 :: Invoice net zero transactions interfaced to Projects stuck '||  'with wrong pa_addition_flag' AS rej_reason  FROM apps.ap_invoice_distributions_all d,  apps.ap_invoices_all i,  apps.pa_projects_all p  WHERE d.project_id > 0  AND p.project_id = d.project_id  AND i.invoice_id = d.invoice_id  AND nvl(d.pa_addition_flag,'N') <> 'Y'  AND d.line_type_lookup_code NOT IN ('REC_TAX','RETAINAGE','PREPAY')  AND d.posted_flag = 'Y'  AND nvl(d.reversal_flag, 'N') = 'Y'  AND nvl(d.historical_flag,'N') = 'N'  AND d.parent_reversal_id is not null  AND d.org_id = i.org_id  AND EXISTS (  SELECT 1 FROM apps.ap_invoice_distributions_all d2  WHERE d.parent_reversal_id = d2.invoice_distribution_id  AND d2.pa_addition_flag = 'Y'  AND nvl(d2.reversal_flag,'N') = 'Y'  AND EXISTS (  SELECT 1 FROM apps.pa_expenditure_items_all ei1  WHERE ei1.document_header_id = d2.invoice_id  AND ei1.document_distribution_id = d2.invoice_distribution_id))  AND EXISTS (  SELECT 1 FROM apps.pa_expenditure_items_all ei  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND ei.document_distribution_type is not null)  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 3 :: Variance transactions interfaced to projects but stuck '||  'with incorrect pa_addition_flag' AS rej_reason  FROM apps.ap_invoice_distributions_all d,  apps.ap_invoices_all i,  apps.pa_projects_all p  WHERE p.project_id = d.project_id  AND i.invoice_id = d.invoice_id  AND nvl(d.pa_addition_flag,'N') <> 'Y'  AND nvl(d.reversal_flag,'N') = 'N'  AND d.posted_flag = 'Y'  AND d.project_id > 0  AND nvl(d.historical_flag,'N') = 'N'  AND d.line_type_lookup_code IN ('ERV','TRV','IPV','TIPV','TERV' )  AND d.org_id = i.org_id  AND EXISTS (  SELECT 'X' FROM apps.pa_expenditure_items_all ei  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND ei.document_distribution_type is not null)  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  UNION All  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 5 :: Invoice transactions not interfaced to projects stuck '||  'with wrong pa_addition_flag' AS rej_reason  FROM apps.ap_invoice_distributions_all d,  apps.ap_invoices_all i,  apps.pa_projects_all p  WHERE d.project_id > 0  AND d.line_type_lookup_code NOT IN (  'NONREC_TAX','ACCRUAL','REC_TAX','RETAINAGE','PREPAY' )  AND d.line_type_lookup_code NOT IN ('ERV','TRV','IPV','TIPV','TERV')  AND d.pa_addition_flag is not null  AND nvl(d.pa_addition_flag,'N') NOT IN ('N','E')  AND d.po_distribution_id is not null  AND d.amount <> 0  AND d.posted_flag ||'' = 'Y'  AND nvl(d.reversal_flag,'N') = 'N'  AND nvl(d.historical_flag,'N') = 'N'  AND p.project_id = d.project_id  AND i.invoice_id = d.invoice_id  AND d.org_id = i.org_id  AND NOT EXISTS (  SELECT 'X' FROM apps.pa_expenditure_items_all ei  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND ei.document_distribution_type is not null  AND nvl(ei.net_zero_Adjustment_Flag,'N') = 'N'  AND ei.org_id = d.org_id)  AND (apps.pa_nl_installed.is_nl_installed = 'N' OR  (apps.pa_nl_installed.is_nl_installed = 'Y' AND  NOT EXISTS (  SELECT 'X'  FROM apps.po_distributions_all pod,  apps.mtl_system_items si,  apps.po_lines_all pol  WHERE pod.po_distribution_id = d.po_distribution_id  AND pod.po_line_id = pol.po_line_id  AND si.inventory_item_id = pol.item_id  AND si.comms_nl_trackable_flag = 'Y'  AND (si.organization_id = pod.org_id OR  si.organization_id IN (  SELECT nvl(ship_to_organization_id,-9999)  FROM apps.po_line_locations_all pll  WHERE pll.po_header_id = pod.po_header_id  AND pll.po_line_id = pod.po_line_id))) AND  NOT EXISTS (  SELECT 'X'  FROM apps.ap_invoice_distributions d,  apps.po_distributions pod,  apps.mtl_system_items si,  apps.po_lines_all pol  WHERE d.charge_applicable_to_dist_id = d.invoice_distribution_id  AND d.po_distribution_id = pod.po_distribution_id  AND pod.po_line_id = pol.po_line_id  AND si.inventory_item_id = pol.item_id  AND si.comms_nl_trackable_flag = 'Y'  AND (si.organization_id = pod.org_id OR  si.organization_id IN (  SELECT nvl(ship_to_organization_id, -9999)  FROM apps.po_line_locations_all pll  WHERE pll.po_header_id = pod.po_header_id  AND pll.po_line_id = pod.po_line_id)))))  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 5 :: Invoice transactions not interfaced to projects stuck '||  'with wrong pa_addition_flag' AS rej_reason  FROM apps.ap_invoice_distributions_all d,  apps.ap_invoices_all i,  apps.pa_projects_all p  WHERE d.project_id > 0  AND d.line_type_lookup_code IN ('NONREC_TAX', 'ACCRUAL')  AND nvl(d.pa_addition_flag,'Y') NOT IN ('G','Z')  AND d.posted_flag ||'' = 'Y'  AND d.amount <> 0  AND nvl(d.reversal_flag,'N') = 'N'  AND nvl(d.historical_flag,'N') = 'N'  AND p.project_id = d.project_id  AND i.invoice_id = d.invoice_id  AND d.org_id = i.org_id  AND EXISTS (  SELECT 1 FROM apps.po_distributions_all pod  WHERE pod.po_distribution_id = d.po_distribution_id  AND pod.accrue_on_receipt_Flag = 'Y'  AND pod.org_id = d.org_id)  AND NOT EXISTS (  SELECT 'X' FROM apps.pa_expenditure_items_all ei  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND ei.document_distribution_type is not null  AND nvl(ei.net_zero_Adjustment_Flag,'N') = 'N'  AND ei.org_id = d.org_id)  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 5 :: Invoice transactions not interfaced to projects stuck '||  'with wrong pa_addition_flag' AS rej_reason  FROM apps.ap_invoice_distributions_all d,  apps.ap_invoices_all i,  apps.pa_projects_all p  WHERE d.project_id > 0  AND d.line_type_lookup_code IN ('NONREC_TAX')  AND nvl(d.pa_addition_flag,'Y') <> 'N'  AND d.amount <> 0  AND d.posted_flag ||'' = 'Y'  AND nvl(d.reversal_flag,'N') = 'N'  AND nvl(d.historical_flag,'N') = 'N'  AND p.project_id = d.project_id  AND i.invoice_id = d.invoice_id  AND d.org_id = i.org_id  AND EXISTS (  SELECT 1 FROM apps.po_distributions_all pod  WHERE pod.po_distribution_id = d.po_distribution_id  AND pod.accrue_on_receipt_Flag = 'N')  AND (apps.pa_nl_installed.is_nl_installed = 'N' OR  (apps.pa_nl_installed.is_nl_installed = 'Y' AND  NOT EXISTS (  SELECT 'X'  FROM apps.po_distributions_all pod,  apps.mtl_system_items si,  apps.po_lines_all pol  WHERE pod.po_distribution_id = d.po_distribution_id  AND pod.po_line_id = pol.po_line_id  AND si.inventory_item_id = pol.item_id  AND si.comms_nl_trackable_flag = 'Y'  AND (si.organization_id = pod.org_id OR  si.organization_id IN (  SELECT nvl(ship_to_organization_id,-9999)  FROM apps.po_line_locations_all pll  WHERE pll.po_header_id = pod.po_header_id  AND pll.po_line_id = pod.po_line_id))) AND  NOT EXISTS (  SELECT 'X'  FROM apps.ap_invoice_distributions d,  apps.po_distributions pod,  apps.mtl_system_items si,  apps.po_lines_all pol  WHERE d.CHARGE_APPLICABLE_TO_DIST_ID = d.invoice_distribution_id  AND d.po_distribution_id = pod.po_distribution_id  AND pod.po_line_id = pol.po_line_id  AND si.inventory_item_id = pol.item_id  AND si.comms_nl_trackable_flag = 'Y'  AND (si.organization_id = pod.org_id OR  si.organization_id IN (  SELECT nvl(ship_to_organization_id, -9999)  FROM apps.po_line_locations_all pll  WHERE pll.po_header_id = pod.po_header_id  AND pll.po_line_id = pod.po_line_id) ))))  AND NOT EXISTS (  SELECT 'X' FROM apps.pa_expenditure_items_all ei  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND ei.document_distribution_type is not null  AND nvl(ei.net_zero_Adjustment_Flag,'N') = 'N'  AND ei.org_id = d.org_id)  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number ,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 6 :: Variance transactions not interfaced to projects but stuck '||  'with incorrect pa_addition_flag ' AS rej_reason  FROM apps.ap_invoice_distributions_all d,  apps.pa_projects_all p,  apps.ap_invoices_all i  WHERE p.project_id = d.project_id  AND i.invoice_id = d.invoice_id  AND nvl(d.pa_addition_flag,'Y') <> 'N'  AND d.posted_flag ||'' = 'Y'  AND d.project_id > 0  AND d.amount <> 0  AND nvl(d.reversal_flag,'N') = 'N'  AND nvl(d.historical_flag,'N') = 'N'  AND d.line_type_lookup_code IN ('ERV','TRV','IPV','TIPV','TERV')  AND i.org_id = d.org_id  AND NOT EXISTS (  SELECT 'X' FROM apps.pa_expenditure_items_all ei  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND nvl(ei.net_zero_Adjustment_Flag,'N') = 'N')  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 8 :: Supplier Invoice matched to Purchase Order having '||  'Accrue on Receipt Flag=N AND is trackable' AS rej_reason  FROM apps.ap_invoice_distributions_all d,  apps.ap_invoices_all i,  apps.pa_projects_all p  WHERE d.project_id > 0  AND d.line_type_lookup_code NOT IN ('REC_TAX','RETAINAGE','PREPAY' )  AND d.line_type_lookup_code NOT IN ('ERV','TRV','IPV','TIPV','TERV' )  AND d.pa_addition_Flag is not null  AND nvl(d.pa_addition_flag,'N') IN ('N')  AND d.po_distribution_id is not null  AND d.amount <> 0  AND d.posted_flag ||'' = 'Y'  AND nvl(d.reversal_flag,'N') = 'N'  AND nvl(d.historical_flag,'N') = 'N'  AND p.project_id = d.project_id  AND i.invoice_id = d.invoice_id  AND d.org_id = i.org_id  AND EXISTS (  SELECT 1 FROM apps.po_distributions_all pod  WHERE pod.po_distribution_id = d.po_distribution_id  AND pod.accrue_on_receipt_Flag = 'N')  AND NOT EXISTS (  SELECT 'X' FROM apps.pa_expenditure_items_all ei  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND ei.document_distribution_type is not null  AND nvl(ei.net_zero_Adjustment_Flag,'N') = 'N'  AND ei.org_id = d.org_id)  AND apps.pa_nl_installed.is_nl_installed = 'Y'  AND EXISTS (  SELECT 'X'  FROM apps.po_distributions_all pod,  apps.mtl_system_items si,  apps.po_lines_all pol  WHERE pod.po_distribution_id = d.po_distribution_id  AND pod.po_line_id = pol.po_line_id  AND si.inventory_item_id = pol.item_id  AND si.comms_nl_trackable_flag = 'Y'  AND (si.organization_id = pod.org_id OR  si.organization_id IN (  SELECT nvl(ship_to_organization_id,-9999)  FROM apps.po_line_locations_all pll  WHERE pll.po_header_id = pod.po_header_id  AND pll.po_line_id = pod.po_line_id)))  AND trunc(d.expenditure_item_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 9 :: Some Invoice Net Zero Distributions interfaced '||  'to PA AND others not interfaced' AS rej_reason  FROM apps.ap_invoice_distributions_all d,  apps.pa_projects_all p,  apps.ap_invoices_all i  WHERE d.project_id = p.project_id  AND i.invoice_id = d.invoice_id  AND d.line_type_lookup_code NOT IN ('REC_TAX')  AND nvl(d.pa_addition_flag,'N') <> 'E'  AND nvl(d.reversal_flag,'N') = 'Y'  AND d.parent_reversal_id is not null  AND d.org_id = i.org_id  AND EXISTS (  SELECT 1 FROM apps.pa_expenditure_items_all ei  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND ei.adjusted_expenditure_item_id is null  AND NOT EXISTS (  SELECT 1 FROM apps.pa_expenditure_items_All ei2  WHERE ei2.adjusted_expenditure_item_id = ei.expenditure_Item_id))  AND EXISTS (  SELECT 1 FROM apps.ap_invoice_distributions_all d2  WHERE d2.invoice_id = d.invoice_id  AND d2.invoice_distribution_id = d.parent_reversal_id  AND d2.line_type_lookup_code NOT IN ('REC_TAX')  AND nvl(d2.pa_addition_Flag,'N') <> 'E'  AND nvl(d2.reversal_flag,'N') = 'Y'  AND NOT EXISTS (  SELECT 1 FROM apps.pa_expenditure_items_all ei1  WHERE ei1.document_header_id = d2.invoice_id  AND ei1.document_distribution_id = d2.invoice_distribution_id))  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 9 :: Some Invoice Net Zero Distributions interfaced '||  'to PA AND others not interfaced' AS rej_reason  FROM apps.ap_invoice_distributions_all d,  apps.pa_projects_all p,  apps.ap_invoices_all i  WHERE d.project_id = p.project_id  AND i.invoice_id = d.invoice_id  AND d.line_type_lookup_code NOT IN ('REC_TAX')  AND nvl(d.pa_addition_flag,'N') <> 'E'  AND nvl(d.reversal_flag,'N') = 'Y'  AND d.parent_reversal_id is not null  AND d.org_id = i.org_id  AND NOT EXISTS (  SELECT 1 FROM apps.pa_expenditure_items_all ei  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id)  AND EXISTS (  SELECT 1 FROM apps.ap_invoice_distributions_all d2  WHERE d2.invoice_id = d.invoice_id  AND d2.invoice_distribution_id = d.parent_reversal_id  AND d2.line_type_lookup_code NOT IN ('REC_TAX')  AND nvl(d2.pa_addition_Flag,'N') <> 'E'  AND nvl(d2.reversal_flag,'N') = 'Y'  AND EXISTS (  SELECT 1 FROM apps.pa_expenditure_items_all ei1  WHERE ei1.document_header_id = d2.invoice_id  AND ei1.document_distribution_id = d2.invoice_distribution_id  AND ei1.adjusted_expenditure_item_id is null  AND NOT EXISTS (  SELECT 1 FROM apps.pa_expenditure_items_All ei3  WHERE ei3.adjusted_expenditure_item_id = ei1.expenditure_Item_id)))  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 14 :: Transactions causing duplicate actuals in PA from '||  'AP Invoices AND PO receipts' AS rej_reason  FROM apps.pa_expenditure_items_all ei,  apps.pa_projects_all p,  apps.pa_tasks t,  apps.ap_invoices_all i,  apps.ap_invoice_distributions_all d,  apps.po_distributions_all pod,  apps.po_headers_all poh  WHERE ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND ei.transaction_source IN ('AP INVOICE','AP NRTAX')  AND ei.DOCUMENT_distribution_type IN ('ACCRUAL','NONREC_TAX')  AND nvl(ei.net_Zero_adjustment_flag, 'N') = 'N'  AND ei.document_header_id is not null  AND ei.document_distribution_id is not null  AND ei.system_linkage_function = 'VI'  AND ei.raw_cost <> 0  AND nvl(ei.historical_flag,'N') = 'N'  AND i.invoice_id = d.invoice_id  AND p.project_id = ei.project_id  AND t.task_id = ei.task_id  AND p.project_id = t.project_id  AND d.po_distribution_id is not null  AND d.po_distribution_id = pod.po_distribution_id  AND d.pa_addition_flag = 'Y'  AND pod.accrue_on_receipt_Flag = 'Y'  AND pod.po_header_id = poh.po_header_id  AND d.project_id is not null  AND nvl(d.historical_flag, 'N') = 'N'  AND d.org_id = i.org_id  AND pod.org_id = poh.org_id  AND EXISTS (  SELECT 1  FROM apps.rcv_receiving_sub_ledger rcv_sub,  apps.rcv_transactions rcvt,  apps.po_distributions_all pod  WHERE rcv_sub.reference3 = to_char(d.po_distribution_id)  AND rcv_sub.reference2 = pod.po_header_id  AND rcvt.po_distribution_id = pod.po_distribution_id  AND rcv_sub.code_combination_id = pod.code_combination_id  AND rcv_sub.actual_flag = 'A'  AND rcvt.transaction_id = rcv_sub.rcv_transaction_id  AND rcv_sub.accounting_line_type = 'Charge')  AND trunc(ei.creation_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 15 :: Retainage Invoice Transactions Interfaced to '||  'Projects' AS rej_reason  FROM apps.pa_cost_distribution_lines_all cdl,  apps.pa_expenditure_items_all ei,  apps.pa_projects_all p,  apps.pa_tasks t,  apps.pa_expenditures_all pae,  apps.po_vendors po,  apps.ap_invoices_all i,  apps.ap_invoice_distributions_all d  WHERE cdl.expenditure_item_id = ei.expenditure_item_id  AND ei.cost_distributed_flag = 'Y'  AND p.project_id = d.project_id  AND i.invoice_id = d.invoice_id  AND p.project_id = ei.project_id  AND t.task_id = ei.task_id  AND pae.expenditure_id = ei.expenditure_id  AND pae.vendor_id = po.vendor_id  AND ei.system_linkage_function = 'VI'  AND ei.transaction_source = 'AP INVOICE'  AND nvl(ei.net_Zero_adjustment_flag, 'N') = 'N'  AND nvl(ei.historical_flag,'N') = 'N'  AND ei.document_header_id is not null  AND ei.document_distribution_id is not null  AND nvl(cdl.reversed_flag, 'N') = 'N'  AND cdl.line_num_reversed is null  AND cdl.line_type = 'R'  AND ei.org_id = cdl.org_id  AND ei.org_id = d.org_id  AND d.org_id = i.org_id  AND cdl.amount <> 0  AND ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND d.project_id > 0  AND nvl(d.pa_addition_flag,'N') = 'Y'  AND d.line_type_lookup_code = 'RETAINAGE'  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  UNION ALL  SELECT p.segment1 project_number,  p.project_status_code project_status,  i.invoice_num invoice_number,  d.pa_addition_flag pa_addition_flag,  'Case 16 : Cash Discount Adjusted Transactions not stamped with '||  'correct Period' AS rej_reason  FROM apps.ap_payment_history_all apha ,  apps.ap_payment_hist_dists aphd,  apps.ap_invoice_distributions_all d,  apps.ap_invoices_all i,  apps.pa_projects_all p,  apps.pa_expenditure_items_all ei,  apps.pa_cost_distribution_lines_all cdl  WHERE apha.accounting_event_id = aphd.accounting_event_id  AND apha.payment_history_id = aphd.payment_history_id  AND aphd.invoice_distribution_id = d.invoice_distribution_id  AND i.invoice_id = d.invoice_id  AND d.project_id = p.project_id  AND aphd.pay_dist_lookup_code = 'DISCOUNT'  AND apha.transaction_type = 'PAYMENT ADJUSTED'  AND ei.expenditure_item_id = cdl.expenditure_item_id  AND cdl.line_num = (  SELECT max(line_num)   FROM apps.pa_cost_distribution_lines_all  WHERE expenditure_item_id = ei.expenditure_item_id)  AND ei.document_header_id = d.invoice_id  AND ei.document_distribution_id = d.invoice_distribution_id  AND cdl.system_reference2 = d.invoice_id  AND ei.project_id = d.project_id  AND ei.task_id = d.task_id  AND cdl.project_id = d.project_id  AND cdl.task_id = d.task_id  AND cdl.GL_date <> d.accounting_date  AND d.org_id = i.org_id  AND d.org_id = ei.org_id  AND ei.org_id = cdl.org_id  AND d.org_id = apha.org_id  AND trunc(d.creation_date) >= sysdate-7  AND rownum = 1  )) s]]>
        </SQLQuery>
        <IsInclude>1</IsInclude>
            <InUse>1</InUse>
            <DBQueryFieldList>
                <DBPatternSeqField>entrytime</DBPatternSeqField>
                <DBPatternField>
                    <DBQueryColName>sensor</DBQueryColName>
                    <FieldName>udfs1</FieldName>
                </DBPatternField>
                <DBPatternField>
                    <DBQueryColName>entrytime</DBQueryColName>
                    <FieldName>time</FieldName>
                </DBPatternField>
                <DBPatternField>
                                        <DBQueryColName>key_data</DBQueryColName>
                                        <FieldName>probkey</FieldName>
                                   </DBPatternField>
            </DBQueryFieldList>
            <IsSystem>0</IsSystem>
            <IsEnabled>1</IsEnabled>
            </DBPattern>
    </Patterns>
        <TagConditions>
            <TagCondition operator="CONTAINS_REGEX" field="udfs1" alertRuleVisible="0">
                <ConditionValues>
                    <ConditionValue>%</ConditionValue>
                </ConditionValues>
                <ConditionTags tagField="mtag">
                    <ConditionTag>#medium_severity_sensor</ConditionTag>
                </ConditionTags>
                <IsSystem>0</IsSystem>
                <IsEnabled>1</IsEnabled>
            </TagCondition>
        </TagConditions>
        <IsHidden>0</IsHidden>
        <IsSMAEnabled>0</IsSMAEnabled>
    </Source>
    <FieldNameMaps>
        <FieldNameMap>
            <Name>udfs1</Name>
            <DisplayName>sensor</DisplayName>
        </FieldNameMap>
        
    </FieldNameMaps>
</LoganContent>